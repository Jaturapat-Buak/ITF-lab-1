<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="lab14css.css">
</head>
<body>
    <h1 id="main" onclick="myFunction()">Jaturapat Kittimaphokin 67070017</h1>
    <div class="avatar">
        <div id="profile" style="position: relative; height: 183px; width: 183px; background-image: url('https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/18aa2243-71fd-4ee0-8e1f-1426d602ad9a/dfnm5m5-55724a02-6303-418d-a46d-04e53cd06f49.jpg/v1/fill/w_1280,h_1280,q_75,strp/buddy_daddies_suwa_rei_icon_by_gintomusashi_dfnm5m5-fullview.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7ImhlaWdodCI6Ijw9MTI4MCIsInBhdGgiOiJcL2ZcLzE4YWEyMjQzLTcxZmQtNGVlMC04ZTFmLTE0MjZkNjAyYWQ5YVwvZGZubTVtNS01NTcyNGEwMi02MzAzLTQxOGQtYTQ2ZC0wNGU1M2NkMDZmNDkuanBnIiwid2lkdGgiOiI8PTEyODAifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uub3BlcmF0aW9ucyJdfQ.zzDixCD5IEK9mkOCOMKVgJ7PpKnjhrDom_cDYk4cWPk'); border-radius: 100%; background-position: center; background-size: cover;">
            <div style="position: absolute; height: 30px; width: 30px; background-color: red; border-radius: 100%; display: flex; justify-content: center; align-items: center; bottom: 3mm; right: 10px;"><p>1</p></div>
        </div>
    </div>
    <br>
    <br>
    <div class="form">
        <label>Username&nbsp;&nbsp;:&nbsp;&nbsp;</label><input type="text" placeholder="Enter" id="input">&nbsp;&nbsp;<button onclick="setUsername()">Set</button>
    </div>
    <br>
    <div class="form">
        <label>Profile Image URL&nbsp;&nbsp;:&nbsp;&nbsp;</label><input type="text" placeholder="Enter" id="image">&nbsp;&nbsp;<button onclick="setImage()">Set</button>
    </div>
    <h2 id = "main">Phone Number List</h2>
    <div class="form">
        <input type="text" placeholder="Name" id="name">&nbsp;&nbsp;
        <input type="text" placeholder="Tel" id="tel">&nbsp;&nbsp;
        <button onclick="addTable()">Add</button>&nbsp;&nbsp;
        <button onclick="saveCSV()">Export</button>
    </div>
    <br><br>
    <div class="tab">
        <table id="phoneTable">
            <tr>
                <th>No.</th>
                <th>Name</th>
                <th>Number</th>
            </tr>
        </table>
    </div>
</body>
</html>

<script>
    let username = document.getElementById("main");
    let input = document.getElementById("input");
    let profile = document.getElementById("profile");
    let imageInput = document.getElementById("image");
    let table = document.getElementById("phoneTable");
    let count = 0;
    let phonenumber = [];

    function setUsername() {
        username.textContent = input.value;
        input.value = "";
    };

    function setImage() {
        profile.style.backgroundImage = "url(" + imageInput.value + ")";
        imageInput.value = "";
    };

    function addTable() {
        count += 1;
        const row = document.createElement("tr");

        const cellNo = document.createElement("td");
        const cellName = document.createElement("td");
        const cellTel = document.createElement("td");

        cellNo.textContent = count;
        cellName.textContent = document.getElementById("name").value;
        cellTel.textContent = document.getElementById("tel").value;

        row.appendChild(cellNo);
        row.appendChild(cellName);
        row.appendChild(cellTel);

        table.appendChild(row);

        let arr = [];
        arr.push(count);
        arr.push(document.getElementById("name").value);
        arr.push(document.getElementById("tel").value);

        phonenumber.push(arr);
        console.log(phonenumber);

        document.getElementById("name").value = "";
        document.getElementById("tel").value = "";
    };

    function saveCSV() {
        const csvContent = phonenumber.map(row => row.join(",")).join("\n"); // Convert array to CSV string
        const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);
        link.setAttribute("href", url);
        link.setAttribute("download", "data.csv");
        link.style.visibility = "hidden";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    };

    function myFunction() {
        location.href = "https://github.com/Jaturapat-Buak";
    };
</script>